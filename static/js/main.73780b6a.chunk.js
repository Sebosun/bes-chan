(this["webpackJsonpbes-chan"]=this["webpackJsonpbes-chan"]||[]).push([[0],{17:function(e,t,n){e.exports={Form:"PostForm_Form__iDZPN",addForm:"PostForm_addForm__Cr1uA",postText:"PostForm_postText__1ECjE",loaderContainer:"PostForm_loaderContainer__lW8uA",postName:"PostForm_postName__3GiiG",postTitle:"PostForm_postTitle__2-EYt",postFile:"PostForm_postFile__20aVq"}},20:function(e,t,n){e.exports={postContainer:"Post_postContainer__2H-c_",Post:"Post_Post__368RX",postImage:"Post_postImage__1hEu_",posterInfo:"Post_posterInfo__2JSeC",postText:"Post_postText__1BiIH"}},22:function(e,t,n){e.exports={Thread:"SingleThread_Thread__1IKCH",threadContainer:"SingleThread_threadContainer__3HP6r",secondThreadContainer:"SingleThread_secondThreadContainer__lOppK",return:"SingleThread_return__AKn8j"}},23:function(e,t,n){e.exports={hideContainer:"HideElement_hideContainer__3kN_x",icon:"HideElement_icon__2sEJw",text:"HideElement_text__3KNsx"}},25:function(e,t,n){e.exports={loaderContainer:"ShowPostForm_loaderContainer__1NRKB",showButton:"ShowPostForm_showButton__2mtQC"}},29:function(e,t,n){e.exports={uploadError:"UploadError_uploadError__1dDWh",message:"UploadError_message__3cAHc"}},33:function(e,t,n){e.exports={postImage:"Image_postImage__2_ySV"}},35:function(e,t,n){e.exports={button:"Button_button__6-R6B"}},36:function(e,t,n){e.exports={expandThread:"ExpandThread_expandThread__N25cj",expand:"ExpandThread_expand__2uuWh"}},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},49:function(e,t,n){},57:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var c=n(3),a=n.n(c),s=n(32),r=n.n(s),o=(n(44),n(5)),i=(n(45),n(6)),d=n(7),l=n(39),j=(n(46),n(20)),u=n.n(j),b=n(33),h=n.n(b),x=n(2),p=function(e){var t=Object(c.useState)({maxHeight:"15vh"}),n=Object(o.a)(t,2),a=n[0],s=n[1];return Object(x.jsx)("img",{alt:"",onClick:function(){"15vh"===a.maxHeight?s({maxHeight:"45vh"}):s({maxHeight:"15vh"})},src:e.src,className:h.a.postImage,style:a})},m=n(23),O=n.n(m),f=n(34),v=function(e){return Object(x.jsxs)("div",{onClick:e.onClick,className:O.a.hideContainer,children:[Object(x.jsx)(f.a,{className:O.a.icon,color:"#00ff46"}),Object(x.jsx)("div",{className:O.a.text,children:e.text})]})};var _=function(e){var t=Object(c.useState)(!0),n=Object(o.a)(t,2),a=n[0],s=n[1],r=Object(c.useState)(""),i=Object(o.a)(r,2),d=i[0],l=i[1];return Object(x.jsxs)("div",{className:u.a.postContainer,children:[Object(x.jsx)(v,{className:u.a.hideElem,text:d,onClick:function(){s((function(e){return!e})),l((function(t){return!1===a?"":e.user?e.user:"Anonymous"}))}}),a&&Object(x.jsx)("div",{className:u.a.Post,children:Object(x.jsxs)("div",{children:[Object(x.jsx)(p,{src:e.image}),Object(x.jsxs)("div",{className:u.a.posterInfo,children:[Object(x.jsx)("div",{id:"user",children:e.user?e.user:"Anonymous"}),Object(x.jsx)("div",{children:e.title}),e.time&&Object(x.jsx)("div",{children:e.time.toDate().toDateString()+" "+e.time.toDate().toLocaleTimeString()}),Object(x.jsxs)("div",{className:"postNo",children:["No. ",e.postNo]})]}),Object(x.jsx)("p",{className:u.a.postText,children:e.text})]})})]})},N=n(15),g=n(19),C=n.n(g),S=n(24),y=n(29),T=n.n(y),F=function(){return Object(x.jsx)("div",{className:T.a.uploadError,children:Object(x.jsx)("p",{className:T.a.message,children:"Please upload an image file"})})},I=n(35),k=n.n(I),P=function(e){return Object(x.jsx)("button",{onClick:e.onClick,className:k.a.button,children:e.children})},w=n(17),E=n.n(w);var B=function(e){var t=Object(c.useState)(""),n=Object(o.a)(t,2),a=n[0],s=n[1],r=Object(c.useState)(""),d=Object(o.a)(r,2),l=d[0],j=d[1],u=Object(c.useState)(""),b=Object(o.a)(u,2),h=b[0],p=b[1],m=Object(c.useState)(null),O=Object(o.a)(m,2),f=O[0],v=O[1],_=Object(c.useState)(!1),N=Object(o.a)(_,2),g=N[0],y=N[1];function T(){return I.apply(this,arguments)}function I(){return(I=Object(S.a)(C.a.mark((function e(){var t,n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.b.firestore(),n=i.b.firestore.FieldValue.increment(1),t.collection("meta").doc("data").update({postNo:n});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return i.b.firestore().collection("meta").doc("data").get().then((function(e){return e.exists?e.data().postNo:0}))}function w(){s(""),j(""),p(""),v(null)}function B(e,t,n,c){return A.apply(this,arguments)}function A(){return(A=Object(S.a)(C.a.mark((function t(n,c,a,s){var r,o,d;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.b.firestore(),t.next=3,k();case 3:o=t.sent,d=r.collection("board"),!1===e.thread&&(d=r.collection("board").doc(e.id).collection("posts")),d.add({user:n,text:c,title:a,postNo:o,created:i.b.firestore.FieldValue.serverTimestamp(),image:s}).then((function(){T().then((function(){e.onSubmit(),e.openCloseForm()}))})).catch((function(e){}));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var D=function(e){e.target.files[0].type.match("image.*")?(console.log(e.target.files[0]),y(!1),v(e.target.files[0])):(y(!0),e.target.value=null)},H=function(){var t=Object(S.a)(C.a.mark((function t(n){var c,s,r;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),e.onSubmit(),null!==f){t.next=7;break}B(a,l,h,""),w(),t.next=13;break;case 7:return c=f,s=i.b.storage().ref(),r=s.child(c.name),t.next=12,r.put(c);case 12:r.getDownloadURL().then((function(e){B(a,l,h,e),w()}));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:E.a.Form,children:Object(x.jsxs)("form",{onSubmit:function(e){H(e)},className:E.a.addForm,children:[Object(x.jsx)("input",{placeholder:"name",value:a,type:"text",onChange:function(e){s(e.target.value)},className:E.a.postName,maxLength:"25"}),Object(x.jsx)("input",{placeholder:"title",value:h,type:"text",onChange:function(e){p(e.target.value)},className:E.a.postTitle,maxLength:"30"}),Object(x.jsx)("textarea",{placeholder:"comment",value:l,type:"text",onChange:function(e){j(e.target.value)},required:!0,className:E.a.postText,maxLength:"1000"}),e.thread?Object(x.jsx)("input",{className:E.a.postFile,type:"file",onChange:D,accept:"image/*",required:!0}):Object(x.jsx)("input",{className:E.a.postFile,type:"file",accept:"image/*",onChange:D}),Object(x.jsx)(P,{className:E.a.postSubmit,children:"Submit"})]})}),g&&Object(x.jsx)(F,{})]})},A=(n(49),function(e){return Object(x.jsxs)("div",{className:"lds-roller",children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{}),Object(x.jsx)("div",{})]})}),D=n(25),H=n.n(D);var L=function(e){var t=Object(c.useState)(!1),n=Object(o.a)(t,2),a=n[0],s=n[1],r=Object(c.useState)(!1),i=Object(o.a)(r,2),d=i[0],l=i[1];function j(){s((function(e){return!e}))}return d?Object(x.jsx)("div",{className:H.a.loaderContainer,children:Object(x.jsx)(A,{})}):Object(x.jsx)("div",{children:a?Object(x.jsxs)("div",{children:[Object(x.jsx)(B,{openCloseForm:j,id:e.id,thread:e.thread,onSubmit:function(){l((function(e){return!e}))}}),Object(x.jsx)("div",{className:H.a.showButton,children:Object(x.jsx)(P,{onClick:j,children:"Close"})})]}):Object(x.jsx)("div",{className:H.a.showButton,children:Object(x.jsx)(P,{onClick:j,children:"".concat(e.thread?"Start a new thread":"Add a reply")})})})},R=n(36),K=n.n(R),W=n(37),q=function(e){return Object(x.jsxs)("div",{className:K.a.expandThread,children:[Object(x.jsxs)("div",{children:[e.postNo-3," posts omitted."]}),Object(x.jsx)(W.a,{onClick:e.onClick,color:"#00ff46",style:{cursor:"pointer"},size:"1.5em"})]})};var z=function(e){var t=Object(c.useState)([]),n=Object(o.a)(t,2),a=n[0],s=n[1],r=Object(c.useState)(!1),d=Object(o.a)(r,2),l=d[0],j=d[1],u=Object(c.useState)(!0),b=Object(o.a)(u,2),h=b[0],m=b[1],O=Object(c.useState)("close"),f=Object(o.a)(O,2),g=f[0],C=f[1],S=Object(c.useState)(!1),y=Object(o.a)(S,2),T=y[0],F=y[1],I=Object(c.useState)(0),k=Object(o.a)(I,2),P=k[0],w=k[1],E=function(t){var n=i.b.firestore();("expand"===t?n.collection("board").doc(e.id).collection("posts").orderBy("postNo","desc"):n.collection("board").doc(e.id).collection("posts").orderBy("postNo","desc").limit(3)).onSnapshot((function(e){var t=e.docs.map((function(e){var t=e.data();return t.id=e.id,t}));t.reverse(),s(t)}))};function B(){j((function(e){return!e}))}return Object(c.useEffect)((function(){i.b.firestore().collection("board").doc(e.id).collection("posts").get().then((function(e){w(e.size)})),E("nope")}),[]),Object(x.jsxs)("div",{className:"Thread",children:[Object(x.jsx)(v,{text:g,onClick:function(){m((function(e){return!e})),C((function(t){return"close"===t?e.user?e.user:"Anyonymous":"close"}))}}),h&&Object(x.jsxs)("div",{className:"threadContainer",children:[l&&Object(x.jsx)(L,{hidden:!0,thread:!1,id:e.id}),Object(x.jsxs)("div",{className:"threadInfo",children:[Object(x.jsx)(p,{src:e.image}),Object(x.jsxs)("div",{className:"threadInfoContainer",children:[Object(x.jsx)("div",{className:"user",id:"user",children:e.user?e.user:"Anyonymous"}),Object(x.jsx)("div",{className:"title",children:e.title?e.title:"Thread"}),e.time?Object(x.jsx)("div",{className:"time",children:e.time.toDate().toDateString()+" "+e.time.toDate().toLocaleTimeString()}):null,Object(x.jsxs)(N.b,{style:{color:"#00ff46"},to:"/thread/".concat(e.postNo),children:["No. ",e.postNo]})]}),Object(x.jsx)("div",{className:"postText",children:Object(x.jsx)("p",{children:e.text})}),T||P-3<=0?null:Object(x.jsx)(q,{onClick:function(){F(!0),E("expand")},postNo:P})]}),a.map((function(e){return Object(x.jsx)(_,{id:e.id,postNo:e.postNo,title:e.title,time:e.created,text:e.text,image:e.image,user:e.user,clickReply:B},e.id)})),Object(x.jsx)(L,{thread:!1,id:e.id})]})]})},J=function(e){return Object(x.jsx)("div",{className:"Threads",children:e.threadArray.map((function(e){return Object(x.jsx)(z,{id:e.id,postNo:e.postNo,title:e.title,time:e.created,text:e.text,image:e.image,user:e.user},e.id)}))})};n(57);var V=function(e){return Object(x.jsxs)("div",{className:"header",children:[Object(x.jsx)(N.b,{to:"/",children:Object(x.jsx)("h1",{children:e.chan})}),Object(x.jsx)("p",{children:e.desc})]})},G=n(22),M=n.n(G),Q=function(){var e=Object(d.f)(),t=Object(c.useState)([]),n=Object(o.a)(t,2),a=n[0],s=n[1],r=Object(c.useState)([]),l=Object(o.a)(r,2),j=l[0],u=l[1];Object(c.useEffect)((function(){i.b.firestore().collection("board").where("postNo","==",parseInt(e.threadID)).onSnapshot((function(e){var t=e.docs.map((function(e){var t=e.data();return t.id=e.id,t}));console.log(t),u(t),b(t[0].id)}))}),[e]);var b=function(e){i.b.firestore().collection("board").doc(e).collection("posts").orderBy("postNo","desc").onSnapshot((function(e){var t=e.docs.map((function(e){var t=e.data();return t.id=e.id,t}));t.reverse(),s(t)}))};return 0===j.length?null:Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:M.a.return,children:Object(x.jsx)(N.b,{to:"/",children:Object(x.jsx)("div",{children:"Return to threads"})})}),Object(x.jsx)("div",{className:M.a.Thread,children:Object(x.jsxs)("div",{className:M.a.threadContainer,children:[Object(x.jsxs)("div",{className:M.a.secondThreadContainer,children:[Object(x.jsxs)("div",{className:"threadInfo",children:[Object(x.jsx)(p,{src:j[0].image}),Object(x.jsxs)("div",{className:"threadInfoContainer",children:[Object(x.jsx)("div",{className:"user",id:"user",children:j[0].user?j[0].user:"Anyonymous"}),Object(x.jsx)("div",{className:"title",children:j[0].title?j[0].title:"Thread"}),j[0].created&&Object(x.jsx)("div",{className:"time",children:j[0].created.toDate().toDateString()+" "+j[0].created.toDate().toLocaleTimeString()}),Object(x.jsxs)("div",{children:["No. ",j[0].postNo]})]}),Object(x.jsx)("div",{className:"postText",children:Object(x.jsx)("p",{children:j[0].text})})]}),a.map((function(e,t){return Object(x.jsx)(_,{id:e.id,postNo:e.postNo,title:e.title,time:e.created,text:e.text,image:e.image,user:e.user},t)}))]}),Object(x.jsx)(L,{thread:!1,id:j[0].id})]})})]})};var U=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){i.b.firestore().collection("board").orderBy("created","desc").onSnapshot((function(e){var t=e.docs.map((function(e){var t=e.data();return t.id=e.id,t}));a(t)}))}),[]),Object(x.jsxs)("div",{className:"App",children:[Object(x.jsxs)(d.c,{children:[Object(x.jsxs)(d.a,{exact:!0,path:"/",children:[Object(x.jsx)(V,{chan:"Bes's",desc:"We cannot guarantee that your brain won't explode"}),Object(x.jsx)(L,{thread:!0}),Object(x.jsx)("main",{children:Object(x.jsx)(J,{threadArray:n})})]}),Object(x.jsxs)(d.a,{path:"/thread/:threadID",children:[Object(x.jsx)(V,{chan:"Bes's",desc:"Don't tell me you expected some quirky text here"}),Object(x.jsx)(Q,{})]})]}),Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",paddingBottom:"10px"},children:Object(x.jsx)("a",{href:"https://github.com/Sebosun/bes-chan",children:Object(x.jsx)(l.a,{color:"black",size:"2em"})})})]})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,62)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),s(e),r(e)}))};n(60),n(61);i.b.initializeApp({apiKey:"AIzaSyA9ApQ3Mhbga323RYlXqaW8X73QWtvprAg",authDomain:"bes-chan.firebaseapp.com",projectId:"bes-chan",storageBucket:"bes-chan.appspot.com",messagingSenderId:"889845667798",appId:"1:889845667798:web:e97a653a43abfcf0963677",measurementId:"G-MHY6F8BPC5"}),r.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(N.a,{children:Object(x.jsx)(U,{})})}),document.getElementById("root")),X()}},[[59,1,2]]]);
//# sourceMappingURL=main.73780b6a.chunk.js.map